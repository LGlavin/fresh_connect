<div id="market-front">
  <style>

    #map { width:100%; height:600px; }
  </style>


<div class="container">
<div id='map'></div>
</div>



<script src='http://api.tiles.mapbox.com/mapbox.js/v1.3.1/mapbox.js'></script>
  <link href='http://api.tiles.mapbox.com/mapbox.js/v1.3.1/mapbox.css' rel='stylesheet' />



<script type='text/javascript'>

var map = L.mapbox.map('map', 'examples.map-9ijuk24y')
    .setView([45, -102], 5);
    <% @markets = Market.all %>
<% @markets.each do |market| %>
        <% if  market.longitude.present? %>
L.mapbox.markerLayer({

    type: 'Feature',
    geometry: {
        type: 'Point',
        coordinates: [<%= market.longitude %>, <%= market.latitude %>]
    },
       properties: {
        Name: '<%= market.name%>', 
        longitude: '<%= market.longitude%>',
        latitude: '<%= market.latitude%>',
        city: '<%= market.city%>',
        postal_code: '<%= market.postal_code %>',
        'marker-size': 'small',
        'marker-color': '#f65'
    }
}).addTo(map);
    <% end %>
<% end %>
</script>



<h3>Listing Markets</h3>

<table>
  <thead>
    <tr>
      <th>Name</th>
      <th>Address</th>
      <th> Time </th>
      <th>Description</th>
    
      
    </tr>
  </thead>

  <tbody>
    <% @markets.each do |market| %>
      <tr>
        <td><%= market.name %></td>
        <td><%= market.address %></td>
        <td><%= market.datetime %></td>
        <td><%= market.description %></td>
       

        <td><%= link_to 'Show', market %></td>
        <td><%= link_to 'Edit', market %></td>
        <td><%= link_to 'Delete', market, method: :delete, data: { confirm: 'Are you sure you want to delete this market?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>
<div class="links">
<%= link_to 'New Market', new_market_path %>
</div>

</div>